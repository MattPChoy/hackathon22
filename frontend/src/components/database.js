let data = [
    {
        "name":"Genies Café",
        "cafID":"1",
        "menu":{
            "Sizes":[
                {
                    "name":"Small",
                    "price":4.4
                },
                {
                    "name":"Large",
                    "price":5.6
                }
            ],
            "extras":0.80
        },
        "geoCoords":{
            "longitude":-27.49821345523199,
            "latitude":153.01017343661277
        },
        "rating":3.9
    },
    {
        "name":"Belltop Café",
        "cafID":"2",
        "menu":{
            "Sizes":[
                {
                    "name":"Small",
                    "price":"X"
                },
                {
                    "name":"Large",
                    "price":"X"
                }
            ],
            "extras":"X"
        },
        "geoCoords":{
            "longitude":-27.4945831123683,
            "latitude":153.01401074174686
        },
        "rating":4.6
    },
    {
        "name":"Café Nano",
        "cafID":"3",
        "menu":{
            "Sizes":[
                {
                    "name":"Small",
                    "price":3.9
                },
                {
                    "name":"Large",
                    "price":5.3
                }
            ],
            "extras":0.60
        },
        "geoCoords":{
            "longitude":-27.500516484177364,
            "latitude":153.01272689941746
        },
        "rating":4.6
    },
    {
        "name":"Bookmark Café",
        "cafID":"4",
        "menu":{
            "Sizes":[
                {
                    "name":"Small",
                    "price":4.6
                },
                {
                    "name":"Large",
                    "price":5.2
                }
            ],
            "extras":0.80
        },
        "geoCoords":{
            "longitude":-27.496010662405034,
            "latitude":153.0136888766878
        },
        "rating":4.3
    },
    {
        "name":"Darwins Café",
        "cafID":"5",
        "menu":{
            "Sizes":[
                {
                    "name":"Small",
                    "price":"X"
                },
                {
                    "name":"Large",
                    "price":"X"
                }
            ],
            "extras":"X"
        },
        "geoCoords":{
            "longitude":-27.496667329205575,
            "latitude":153.01132853283136
        },
        "rating":4.1
    },
    {
        "name":"BrewPoint",
        "cafID":"6",
        "menu":{
            "Sizes":[
                {
                    "name":"Small",
                    "price":4.4
                },
                {
                    "name":"Large",
                    "price":5.2
                }
            ],
            "extras":0.50
        },
        "geoCoords":{
            "longitude":-27.496629261671927,
            "latitude":153.01652128903248
        },
        "rating":4.9
    },
    {
        "name":"Wordsmiths Café",
        "cafID":"7",
        "menu":{
            "Sizes":[
                {
                    "name":"Small",
                    "price":4.2
                },
                {
                    "name":"Large",
                    "price":5.4
                }
            ],
            "extras":0.50
        },
        "geoCoords":{
            "longitude":-27.498028999430552,
            "latitude":153.01423387640847
        },
        "rating":3.9
    },
    {
        "name":"Lakeside Café",
        "cafID":"8",
        "menu":{
            "Sizes":[
                {
                    "name":"Small",
                    "price":3.9
                },
                {
                    "name":"Large",
                    "price":5.3
                }
            ],
            "extras":0.60
        },
        "geoCoords":{
            "longitude":-27.499209071846018,
            "latitude":153.01538186176694
        },
        "rating":4.3
    },
    {
        "name":"Saint Lucy Caffe e Cucina",
        "cafID":"9",
        "menu":{
            "Sizes":[
                {
                    "name":"Small",
                    "price":4.0
                },
                {
                    "name":"Large",
                    "price":5.0
                }
            ],
            "extras":0.50
        },
        "geoCoords":{
            "longitude":-27.494415665848777,
            "latitude":153.01499829964163
        },
        "rating":4.2
    },
    {
        "name":"Pantry Sixty Three",
        "cafID":"10",
        "menu":{
            "Sizes":[
                {
                    "name":"Small",
                    "price":"3.6"
                },
                {
                    "name":"Large",
                    "price":"5.9"
                }
            ],
            "extras":"3.9"
        },
        "geoCoords":{
            "longitude":-27.499027683276275,
            "latitude":153.01218939964158
        },
        "rating":3.7
    },
    {
        "name":"Mr Beans Coffee Espresso Bar",
        "cafID":"11",
        "menu":{
            "Sizes":[
                {
                    "name":"Small",
                    "price":4.0
                },
                {
                    "name":"Large",
                    "price":5.2
                }
            ],
            "extras":0.60
        },
        "geoCoords":{
            "longitude":-27.497232166335774,
            "latitude":153.0155661284767
        },
        "rating":3.3
    },
    {
        "name":"Merlo Coffee Café",
        "cafID":"12",
        "menu":{
            "Sizes":[
                {
                    "name":"Small",
                    "price":4.4
                },
                {
                    "name":"Large",
                    "price":5.6
                }
            ],
            "extras":0.80
        },
        "geoCoords":{
            "longitude":-27.4966326042281,
            "latitude":153.01443960078842
        },
        "rating":4.1
    },
    {
        "name":"On a Roll Bakery",
        "cafID":"13",
        "menu":{
            "Sizes":[
                {
                    "name":"Small",
                    "price":3.5
                },
                {
                    "name":"Large",
                    "price":4.7
                }
            ],
            "extras":0.60
        },
        "geoCoords":{
            "longitude":-27.497127481123723,
            "latitude":153.01592018003586
        },
        "rating":4.3
    },
    {
        "name":"Yumantra",
        "cafID":"14",
        "menu":{
            "Sizes":[
                {
                    "name":"Small",
                    "price":"4"
                },
                {
                    "name":"Large",
                    "price":"4"
                }
            ],
            "extras":"4"
        },
        "geoCoords":{
            "longitude":-27.499058538117943,
            "latitude":153.01217102094435
        },
        "rating":4.9
    },
    {
        "name":"The Deck Café",
        "cafID":"15",
        "menu":{
            "Sizes":[
                {
                    "name":"Small",
                    "price":"X"
                },
                {
                    "name":"Large",
                    "price":"X"
                }
            ],
            "extras":"X"
        },
        "geoCoords":{
            "longitude":-27.49576263216666,
            "latitude":153.01586189964164
        },
        "rating":5.0
    },
    {
        "name":"The Bagel Boys",
        "cafID":"16",
        "menu":{
            "Sizes":[
                {
                    "name":"Small",
                    "price":"X"
                },
                {
                    "name":"Large",
                    "price":"X"
                }
            ],
            "extras":"X"
        },
        "geoCoords":{
            "longitude":-27.496724595738243,
            "latitude":153.0113542511697
        },
        "rating":4.6
    },
    {
        "name":"Patina",
        "cafID":"17",
        "menu":{
            "Sizes":[
                {
                    "name":"Small",
                    "price":"X"
                },
                {
                    "name":"Large",
                    "price":"X"
                }
            ],
            "extras":"X"
        },
        "geoCoords":{
            "longitude":-27.498279051213455,
            "latitude":153.01282545760418
        },
        "rating":4.6
    },
    {
        "name":"Guzman y Gomez",
        "cafID":"18",
        "menu":{
            "Sizes":[
                {
                    "name":"Small",
                    "price":2
                },
                {
                    "name":"Large",
                    "price":3
                }
            ],
            "extras":"X"
        },
        "geoCoords":{
            "longitude":-27.49889011621703,
            "latitude":153.01210491855687
        },
        "rating":3.7
    },
    {
        "name":"Ezy Mart",
        "cafID":"19",
        "menu":{
            "Sizes":[
                {
                    "name":"Small",
                    "price":2
                },
                {
                    "name":"Large",
                    "price":3
                }
            ],
            "extras":0.0
        },
        "geoCoords":{
            "longitude":-27.498116383243914,
            "latitude":153.01448844952583
        },
        "rating":4.6
    }
]

function distance_between(lat1, lon1, lat2, lon2) {
    return Math.abs(lat2-lat1) + Math.abs(lon2-lon1);
}

function midpoint(points) {
    let lat_sum = 0
    let lon_sum = 0
    let n_pts = 0

    points.forEach((e) => {
        lat_sum += e["lat"]
        lon_sum += e["lon"]
        n_pts += 1
    })

    return {"lat": lat_sum / n_pts, "lon": lon_sum / n_pts};
}

function get_cafes(position) {
    let dist = []
    let distances = {
    }

    data.forEach((elem) => {
        let name = elem["name"];
        let price = elem["menu"]["Sizes"][1]["price"];
        let rating = elem["rating"];
        let lon = elem["geoCoords"]["latitude"];
        let lat = elem["geoCoords"]["longitude"];

        let d = distance_between(position["lat"], position["lon"], lat, lon) * 1000
        distances[d] = { name, price, rating }
        dist.push(d)

        console.log(name + "/" + d)
    });

    dist.sort()

    let reccommendations = []
    dist.forEach((elem) => {
        reccommendations.push(distances[elem]);
    })
    return reccommendations;
}

function get_json_from_name(name) {
    data.forEach((elem) => {
        let elem_name = elem["name"];
        if (name === elem_name) {
            return elem;
        }
    })

    return -1;
}

function get_reccommendation(points, max_price, min_rating, n) {
    // First, compute weighted midpoint
    let mid = midpoint(points);
    console.log("=>" + mid["lat"] + ", " + mid["lon"])

    // Cafes within shortest distance to that midpoint.
    let reccommendations = get_cafes(mid);

    // Filter

    return reccommendations
}

// Modwest
let posA = {"lat": -27.49595320268324, "lon": 153.0118485295724}
// AEB
let posB = {"lat": -27.49958491072012, "lon": 153.01478455256785}
// Union College
let posC = {"lat": -27.500700214102945, "lon": 153.00955067664674}



console.log(get_reccommendation([posA, posB, posC], 4, 1, 5))

export default get_reccommendation